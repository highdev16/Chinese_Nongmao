(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33527f60"],{"0408":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"order-pay"},[t.gotoPay?t._e():a("div",{staticClass:"order-main"},[a("div",{staticClass:"order-detail"},[t._m(0),a("div",{staticClass:"r-box"},[a("div",{staticClass:"order-tips"},[a("div",{staticClass:"title"},[t._v(t._s(t.$L("订单编号")+"："+(t.routerData.hasOwnProperty("orderInfo")&&t.routerData.orderInfo.hasOwnProperty("orderSn")?t.routerData.orderInfo.orderSn:""))+"\n                    ")]),a("div",{staticClass:"n"},[t._v(t._s(t.$L("订单已提交，请尽快完成支付")))])]),a("div",{staticClass:"order-list"},[a("ul",[a("li",[t._v(t._s(t.$L("订单金额："))),a("span",{staticStyle:{color:"#FF0000"}},[t._v(t._s(t.routerData.hasOwnProperty("orderInfo")&&t.routerData.orderInfo.hasOwnProperty("orderAmount")?t.routerData.orderInfo.orderAmount:""))])]),a("li",[t._v(t._s(t.$L("配送地址：")+(t.routerData.hasOwnProperty("orderInfo")&&t.routerData.orderInfo.hasOwnProperty("address")&&t.routerData.orderInfo.address?t.routerData.orderInfo.address:""))+"\n                        ")]),a("li",[t._v(t._s(t.$L("联系电话：")+(t.routerData.hasOwnProperty("orderInfo")&&t.routerData.orderInfo.hasOwnProperty("mobile")&&t.routerData.orderInfo.address?t.routerData.orderInfo.mobile:""))+"\n                        ")])])])])]),a("div",{staticClass:"pay-type"},[a("div",{staticClass:"pay-title"},[t._v(t._s(t.$L("选择支付方式")))]),a("div",{staticClass:"pay-box"},[t.routerData.hasOwnProperty("payListArr")?a("ul",{staticClass:"r-pay"},t._l(t.routerData.payListArr,(function(e,s){return a("li",{key:s,staticClass:"li"},[a("el-radio-group",{model:{value:t.payId,callback:function(e){t.payId=e},expression:"payId"}},[a("el-radio",{attrs:{label:e.payid}},[a("img",{staticClass:"img",attrs:{src:e.logo,alt:""}})])],1)],1)})),0):t._e()])]),a("div",{staticClass:"bottom"},[a("el-button",{attrs:{size:"medium"},on:{click:t.closeFunc}},[t._v(t._s(t.$L("关闭")))]),a("el-button",{attrs:{size:"medium"},on:{click:t.orderInfo}},[t._v(t._s(t.$L("查看订单详情")))]),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.payOrder}},[t._v(t._s(t.$L("立即支付")))])],1)]),t.gotoPay?a("iframe",{ref:"ifr",staticClass:"windows",style:{height:t.height},attrs:{src:t.payUrl},on:{load:t.onLoad}}):t._e()])},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"l-box"},[a("i",{staticClass:"bbx-font bbx-icon-zhifu1"})])}],n=(a("cc57"),{name:"orderPay",inject:["reload"],props:{height:{type:String,default:""},loading:{type:Boolean,default:!1},data:{type:Object,default:function(){return{}}},listener:{type:Object,default:function(){return{}}}},watch:{listener:function(t,e){t&&t.hasOwnProperty("order")&&this.payListen(t.order,t.data)}},data:function(){return{payId:0,routerData:{},gotoPay:!1}},computed:{payUrl:{get:function(){return this.$C("serverUrlAjax")+"/exusers/u_payin_finish.php?order_id="+this.data.orderId+"&pay_id="+this.payId+"&vue=1&lang="+this.$langID()}}},created:function(){this.getData()},methods:{payListen:function(t,e){var a=this;switch(t){case"showError":e.hasOwnProperty("msg")&&this.$alert(e.msg,e.hasOwnProperty("title")?e.title:this.$L("支付失败"),{confirmButtonText:this.$L("确定"),type:"error",showClose:!1}).then((function(){a.closeLoading(),a.gotoPay=!1}));break;case"gotoOrderInfo":this.orderInfo(),e.hasOwnProperty("msg")&&e.msg&&""!==e.msg&&this.$message({message:e.msg,type:"success"});break;case"payInfo":e.hasOwnProperty("info")&&this.$alert(e.info,this.$L("支付提示"),{confirmButtonText:this.$L("确定"),type:"warning",showClose:!1}).then((function(){a.orderInfo()}));break;case"getGiftCard":e.hasOwnProperty("msg")&&e.msg&&""!==e.msg&&0==this.$cookies.isKey("userCardToken")?this.$confirm(e.msg,this.$L("提示"),{confirmButtonText:this.$L("确定"),cancelButtonText:this.$L("不在提示"),type:"warning"}).then((function(){a.$emit("closeDialog"),a.$router.push({name:"userCard"})})).catch((function(t){"cancel"==t&&a.$cookies.set("userCardToken","userCard","3y"),a.$emit("closeDialog"),a.reload()})):(this.$emit("closeDialog"),this.$message({message:this.$L("订单支付成功"),type:"success"}),this.reload());break}},onLoad:function(){this.$refs.ifr.contentWindow.postMessage({msg:"isVue"},this.$C("serverUrlAjax"))},payOrder:function(){0===this.payId?this.$message.error("请选择支付方式"):(this.showLoading(),this.gotoPay=!0)},orderInfo:function(){var t=this;this.closeFunc(),"orderInfo"===this.$route.name&&this.$route.params.id===this.data.orderId?setTimeout((function(){t.reload()}),500):this.$router.push({name:"orderInfo",params:{id:this.data.orderId}})},showLoading:function(){this.$emit("showDialogLoading")},closeLoading:function(){this.$emit("closeDialogLoading")},closeFunc:function(){this.$emit("closeDialog")},getData:function(){var t=this;t.data.hasOwnProperty("orderId")?t.$api("payOrder",{orderId:t.data.orderId},(function(e){1===e.flag?(t.routerData=e.data,console.log("_self.routerData",t.routerData),t.closeLoading()):-1===e.flag?t.$confirm(t.$L("请重新登录"),t.$L("登录超时"),{confirmButtonText:t.$L("重新登录"),cancelButtonText:t.$L("返回首页"),type:"error",distinguishCancelAndClose:!0}).then((function(){t.$router.push({name:"login",query:{redirect:t.$route.fullPath}})})).catch((function(e){t.$gotoWebHome()})):t.$confirm(t.$L("数据加载失败"),t.$L("出错了"),{confirmButtonText:t.$L("重试"),cancelButtonText:t.$L("关闭"),type:"error",distinguishCancelAndClose:!0}).then((function(){t.getData()})).catch((function(e){t.closeFunc()}))}),(function(e){t.$confirm(t.$L("数据加载失败"),t.$L("出错了"),{confirmButtonText:t.$L("点击"),cancelButtonText:t.$L("关闭"),type:"error",distinguishCancelAndClose:!0}).then((function(){t.getData()})).catch((function(e){t.closeFunc()}))})):t.$confirm(t.$L("参数有误"),t.$L("出错了"),{confirmButtonText:t.$L("点击重试"),cancelButtonText:t.$L("关闭窗口"),type:"error",distinguishCancelAndClose:!0}).then((function(){t.getData()})).catch((function(e){t.closeFunc()}))}}}),i=n,o=(a("2201"),a("4023")),c=Object(o["a"])(i,s,r,!1,null,"09cbb896",null);e["a"]=c.exports},2201:function(t,e,a){"use strict";var s=a("47d6"),r=a.n(s);r.a},"47d6":function(t,e,a){},"4d21":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"reservation"},[a("div",{staticClass:"top-menu"},[a("div",{staticClass:"search-item right"},[a("span",[t._v(t._s(t.$L("预约日期"))+"：")]),a("el-date-picker",{staticClass:"time-search",staticStyle:{width:"300px"},attrs:{type:"daterange",align:"right",size:"small","start-placeholder":t.$L("开始日期"),"end-placeholder":t.$L("结束日期"),"value-format":"yyyy-MM-dd"},on:{change:t.SearchTimeFunc},model:{value:t.SearchTimeZone,callback:function(e){t.SearchTimeZone=e},expression:"SearchTimeZone"}}),a("el-select",{staticClass:"search",attrs:{size:"small"},on:{change:t.changeTypeFunc},model:{value:t.messageType,callback:function(e){t.messageType=e},expression:"messageType"}},t._l(t.typeList,(function(t){return a("el-option",{key:t.type,attrs:{label:t.name,value:t.type}})})),1),a("el-input",{staticClass:"input-with-select",attrs:{placeholder:t.$L("输入预约订单/订单号"),size:"small",clearable:""},on:{change:t.searchFunc},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.target.blur(e)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1)]),t.tableData&&t.tableData.hasOwnProperty("list")&&t.tableData.list.length>0?a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"reservation-content"},[t._l(t.tableData.list,(function(e,s){return a("div",{key:s,staticClass:"list-main"},[a("div",{staticClass:"list-msg"},[a("span",{staticClass:"inner-span"},[t._v(t._s(t.$L("订单编号"))+"："+t._s(e.orderSn))]),a("span",{staticClass:"order-time"},[t._v(t._s(t.$L("下单时间"))+"："+t._s(e.addTime))])]),a("div",{staticClass:"list-head"},[a("div",{staticClass:"item item-two"},[t._v(t._s(t.$L("预约订单")))]),a("div",{staticClass:"item item-one"},[t._v(t._s(t.$L("价格")))]),a("div",{staticClass:"item item-one"},[t._v(t._s(t.$L("预付金额")))]),a("div",{staticClass:"item item-one"},[t._v(t._s(t.$L("预约日期")))]),a("div",{staticClass:"item item-one"},[t._v(t._s(t.$L("订单状态")))]),a("div",{staticClass:"item item-three"},[t._v(t._s(t.$L("操作")))])]),a("div",{staticClass:"list-info"},[a("div",{staticClass:"item item-two"},[a("div",{staticClass:"info"},[a("div",{staticClass:"list-main-left"},[a("img",{attrs:{src:e.productPic,alt:""}})]),a("div",{staticClass:"list-main-right"},[a("p",{staticClass:"order-info"},[t._v(t._s(e.proName))])])])]),a("div",{staticClass:"item item-one"},[a("div",{staticClass:"price font-grey"},[t._v(t._s(e.orderAmount))])]),a("div",{staticClass:"item item-one"},[a("div",{staticClass:"price font-red"},[t._v(t._s(e.moneyPaid))])]),a("div",{staticClass:"item item-one"},[a("div",{staticClass:"font"},[t._v("\n                        "+t._s(e.bookTime)),a("br"),e.timeSpec?a("span",[t._v(t._s(e.timeSpec))]):t._e()])]),a("div",{staticClass:"item item-one"},[1==e.order_status?a("div",{staticClass:"font font-red"},[t._v(t._s(t.$L("待处理")))]):2==e.order_status?a("div",{staticClass:"font"},[t._v(t._s(t.$L("已消费")))]):3==e.order_status?a("div",{staticClass:"font"},[t._v(t._s(t.$L("已取消预约")))]):4==e.order_status&&0===e.comments_status?a("div",{staticClass:"font"},[t._v(t._s(t.$L("待评价")))]):4==e.order_status&&1===e.comments_status?a("div",{staticClass:"font"},[t._v(t._s(t.$L("已评价")))]):5==e.order_status?a("div",{staticClass:"font"},[t._v(t._s(t.$L("已逾期")))]):a("div",{staticClass:"font"},[t._v(t._s(t.$L("未知状态")))]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.getInfoFunc(e.id)}}},[t._v(t._s(t.$L("订单详情")))])],1),a("div",{staticClass:"item item-three"},[1===e.order_status&&0===e.pay_status?a("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.changeOrderType(e,"pay")}}},[t._v(t._s(t.$L("立即支付")))]):t._e(),1===e.order_status?a("el-button",{attrs:{type:"default"},on:{click:function(a){return t.changeOrderType(e,"cancel")}}},[t._v(t._s(t.$L("取消预约")))]):e.order_status>=3?a("el-button",{attrs:{type:"default"},on:{click:function(a){return t.changeOrderType(e,"del")}}},[t._v(t._s(t.$L("删除订单")))]):t._e(),e.order_status>=3&&0===e.comments_status?a("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.changeOrderType(e,"evaluate")}}},[t._v(t._s(t.$L("去评价")))]):t._e(),e.order_status>=3&&1===e.comments_status?a("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.changeOrderType(e,"evaluateInfo")}}},[t._v(t._s(t.$L("查看评价")))]):t._e()],1)])])})),t.tableData.allNum>t.pageSize?a("div",{staticClass:"list-pages"},[a("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-sizes":[10,20,30],"page-size":t.pageSize,layout:"prev, pager, next, jumper",total:t.tableData.allNum},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()],2):a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"tips"},[a("p",{staticClass:"no-list"},[t._v(t._s(t.$L("无预约信息")))])])])},r=[],n=a("0408"),i={name:"reservation",components:{orderPay:n["a"]},data:function(){return{loading:!0,errorType:"error",errorTitle:this.$L("出错了"),errorTips:null,errorShow:!1,SearchTimeZone:"",messageType:"all",typeList:[{type:"all",name:this.$L("全部时间")},{type:"seven",name:this.$L("近7天订单")},{type:"thirty",name:this.$L("近30天订单")},{type:"halfYear",name:this.$L("近半年订单")},{type:"year",name:this.$L("近1年订单")},{type:"yearAgo",name:this.$L("1年以前订单")}],currentPage:1,pageSize:10,dtCreateStart:"",dtCreateEnd:"",timeScreening:"all",inputValue:"",tableData:{},type:"all"}},beforeRouteUpdate:function(t,e,a){this.getData(t),a()},created:function(){this.getData()},methods:{showError:function(t,e,a){this.errorType="warning"===a?"warning":"error",this.errorTitle=t&&""!==t?t:this.$L("出错了"),this.errorTips=e&&""!==e?e:null,this.loading=!1,this.errorShow=!0},getData:function(t){var e=this;t||(t=e.$route),e.loading=!0;var a={searchStatus:t.params.type?t.params.type:"all",p:e.currentPage,num:e.pageSize,dtCreateStart:e.dtCreateStart,dtCreateEnd:e.dtCreateEnd,timeScreening:e.messageType,keyword:e.inputValue};e.$api("getReservationList",a,(function(t){1===t.flag?(e.tableData=t.data,e.loading=!1):-1===t.flag?e.$confirm(e.$L("请重新登录"),e.$L("登录超时"),{confirmButtonText:e.$L("重新登录"),cancelButtonText:e.$L("取消"),type:"error",distinguishCancelAndClose:!0}).then((function(){e.$router.push({name:"login",query:{redirect:e.$route.fullPath}})})).catch((function(t){e.$gotoWebHome()})):e.$confirm(e.$L("数据加载失败"),e.$L("出错了"),{confirmButtonText:e.$L("点击重试"),cancelButtonText:e.$L("返回首页"),type:"error",distinguishCancelAndClose:!0}).then((function(){e.getData()})).catch((function(t){e.$router.push({name:"home"})}))}),(function(t){e.$confirm(e.$L("网络请求失败"),e.$L("出错了"),{confirmButtonText:e.$L("点击重试"),cancelButtonText:e.$L("返回首页"),type:"error",distinguishCancelAndClose:!0}).then((function(){e.getData()})).catch((function(t){e.$router.push({name:"home"})}))}))},backFunc:function(){this.$router.back(-1)},SearchTimeFunc:function(t){null!==t?(this.dtCreateStart=t[0],this.dtCreateEnd=t[1]):(this.dtCreateStart="",this.dtCreateEnd=""),this.getData()},searchFunc:function(t){this.inputValue=t,this.getData()},changeTypeFunc:function(t){this.messageType=t,this.getData()},handleSizeChange:function(t){console.log(t)},handleCurrentChange:function(t){this.currentPage=t,this.getData()},changeOrderType:function(t,e){var a=this;switch(e){case"pay":1!==t.order_status&&0!==t.pay_status||this.$store.commit("setDialogObj",{name:this.$L("订单支付"),view:n["a"],width:"900px",loading:!0,data:{orderId:t.orderId}});break;case"cancel":1===t.order_status&&this.$confirm(this.$L("确认取消订单吗？"),this.$L("取消订单"),{confirmButtonText:this.$L("立即取消"),cancelButtonText:this.$L("我再想想"),type:"warning",distinguishCancelAndClose:!0}).then((function(){a.showLoad(!0),a.$api("cancleReservation",{orderId:t.orderId},(function(t){a.showLoad(!1),t&&1===t.flag?(a.$message.success(a.$L("操作成功！")),a.getData()):(console.log(t),a.$message.error(a.$L("操作失败！请稍后重试！")))}),(function(t){console.log(t),a.$message.error(a.$L("操作失败！请稍后重试！")),a.showLoad(!1)}))})).catch((function(t){}));break;case"del":t.order_status>=3&&this.$confirm(this.$L("是否确认删除订单？"),this.$L("删除订单"),{confirmButtonText:this.$L("立即删除"),cancelButtonText:this.$L("我再想想"),type:"warning",distinguishCancelAndClose:!0}).then((function(){a.showLoad(!0),a.$api("delReservation",{orderId:t.orderId},(function(t){a.showLoad(!1),t&&1===t.flag?(a.$message.success(a.$L("操作成功！")),a.getData()):(console.log(t),a.$message.error(a.$L("操作失败！请稍后重试！")))}),(function(t){console.log(t),a.$message.error(a.$L("操作失败！请稍后重试！")),a.showLoad(!1)}))})).catch((function(t){}));break;case"evaluate":t.order_status>=3&&0===t.comments_status&&this.$router.push({name:"resOrderComment",params:{id:t.orderId}});break;case"evaluateInfo":t.order_status>=3&&1===t.comments_status&&this.$router.push({name:"resCheckComment",params:{id:t.orderId}});break}},showLoad:function(t){"undefined"===typeof t||t?this.loading=this.$loading({lock:!0}):this.loading&&(this.loading.close(),this.loading=null)},getInfoFunc:function(t){this.$router.push({name:"reservationInfo",params:{id:t}})}}},o=i,c=(a("7c22"),a("4023")),l=Object(c["a"])(o,s,r,!1,null,"94960be0",null);e["default"]=l.exports},"7c22":function(t,e,a){"use strict";var s=a("7d34"),r=a.n(s);r.a},"7d34":function(t,e,a){}}]);
//# sourceMappingURL=chunk-33527f60.c1088848.js.map