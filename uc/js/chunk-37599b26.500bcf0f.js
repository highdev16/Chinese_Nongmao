(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37599b26"],{"31d4":function(t,e,n){"use strict";var s=n("eb92"),a=n.n(s);a.a},"4b4b":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"order-comment"},[n("div",{staticClass:"comment-content"},[t._l(t.commentOrderInfo,(function(e,s){return n("div",{staticClass:"comment-item"},[n("div",{staticClass:"top-box"},[n("img",{staticClass:"img left",attrs:{src:e.smallImg,alt:""}}),n("div",{staticClass:"text-box left"},[n("p",{staticClass:"order-info"},[t._v(t._s(e.chrName))]),n("div",{staticClass:"block"},[n("span",{staticClass:"demonstration"},[t._v(t._s(t.$L("综合评分")))]),n("el-rate",{attrs:{disabled:""},model:{value:e.meanScore,callback:function(n){t.$set(e,"meanScore",n)},expression:"item.meanScore"}})],1)])]),n("el-input",{staticClass:"desc",attrs:{rows:5,maxlength:"500",placeholder:t.$L("写下您的评价")+"...",resize:"none",type:"textarea"},on:{change:function(n){return t.inputChange(e.prodId)}},model:{value:e.prodText,callback:function(n){t.$set(e,"prodText",n)},expression:"item.prodText"}}),n("p",{staticStyle:{"text-align":"right"}},[n("span",{staticClass:"desc-num gary"},[t._v(t._s(e.prodText?e.prodText.length:0)+"/500")])]),n("uploadPic",{attrs:{id:e.prodId},on:{UpLoadPic:t.getImg}})],1)})),n("div",{staticClass:"comment-bottom"},[n("div",{staticClass:"title"},[t._v(t._s(t.$L("网站动态评分")))]),n("div",{staticClass:"rate-box"},[n("p",{staticClass:"p"},[n("span",{staticClass:"red"},[t._v("*")]),t._v(t._s(t.$L(" 宝贝与描述相符"))),n("el-rate",{model:{value:t.product,callback:function(e){t.product=e},expression:"product"}})],1),n("p",{staticClass:"p"},[n("span",{staticClass:"red"},[t._v("*")]),t._v(t._s(t.$L(" 卖家的服务态度"))),n("el-rate",{model:{value:t.service,callback:function(e){t.service=e},expression:"service"}})],1),n("p",{staticClass:"p"},[n("span",{staticClass:"red"},[t._v("*")]),t._v(t._s(t.$L(" 物流服务的质量"))),n("el-rate",{model:{value:t.logistics,callback:function(e){t.logistics=e},expression:"logistics"}})],1)]),n("el-button",{attrs:{size:"larger",type:"primary"},on:{click:t.submitFunc}},[t._v(t._s(t.$L("评价详情")))])],1)],2)])},a=[],i=n("4f54"),o=n("af9a"),r={name:"orderComment",components:{uploadPic:o["a"]},data:function(){return{loading:!0,errorType:"error",errorTitle:this.$L("出错了"),errorTips:null,errorShow:!1,commentOrderInfo:null,product:5,service:5,logistics:5,score:[],addComment:null,evaluate:{},imgList:[],Eval:{Product:[],Service:[]},prodText:"",idSpecPrice:[],idProduct:[]}},created:function(){var t=0;this.$route.params.hasOwnProperty("id")&&(t=this.$route.params.id,t=parseInt(t)),!isNaN(t)&&t?this.getData(t):this.showError()},methods:{backFunc:function(){this.$router.push({name:"orderList",params:{type:"all"}})},showError:function(){var t=this;this.$alert(this.$L("订单不存在或已删除"),this.$L("参数有误"),{confirmButtonText:this.$L("返回"),type:"error"}).then((function(){t.backFunc()}))},getData:function(t){var e=this;e.loading=!0,e.$api("commentOrderInfo",{orderId:t},(function(n){1===n.flag?(e.commentOrderInfo=n.data.commentList,e.loading=!1):-1===n.flag?e.$confirm(e.$L("请重新登录"),e.$L("登录超时"),{confirmButtonText:e.$L("重新登录"),cancelButtonText:e.$L("返回首页"),type:"error",distinguishCancelAndClose:!0}).then((function(){e.$router.push({name:"login",query:{redirect:e.$route.fullPath}})})).catch((function(t){e.$gotoWebHome()})):e.$confirm(e.$L("数据加载失败"),e.$L("出错了"),{confirmButtonText:e.$L("重试"),cancelButtonText:e.$L("返回"),type:"error",distinguishCancelAndClose:!0}).then((function(){e.getData(t)})).catch((function(t){e.backFunc()}))}),(function(n){e.$confirm(e.$L("数据加载失败"),e.$L("出错了"),{confirmButtonText:e.$L("重试"),cancelButtonText:e.$L("返回"),type:"error",distinguishCancelAndClose:!0}).then((function(){e.getData(t)})).catch((function(t){e.backFunc()}))}))},getImg:function(t,e){this.imgList[e]={fileList:t}},inputChange:function(t){for(var e in this.commentOrderInfo)this.commentOrderInfo[e]["prodId"]==t&&(this.Eval.Product[t]=this.commentOrderInfo[e]["prodText"],this.Eval.Service[t]=this.$L("非常好"))},handleRemove:function(t){this.uploadList.splice(t,1),this.showImgArr.splice(t,1),this.uploadLen=this.showImgArr.length},upImgFunc:function(t){var e=this,n=t.target.files,s=e.uploadLen,a=n.length+s;a<e.maxNum&&e.$message({showClose:!0,message:"最多可上传"+e.maxNum+"张，您还可以上传"+(e.maxNum-a)+"张",type:"success"});for(var o=function(t){var s=null,a=Math.floor(n[t].size/1024),i=n[t].type.substring(6);if(a>2097152)return e.$Message({showClose:!0,message:"请选择2M以内的图片！",type:"warning"}),{v:!1};if("png"!==i&&"jpeg"!==i&&"jpg"!==i)return e.$Message({showClose:!0,message:"请选择png、jpeg、jpg的图片格式！",type:"warning"}),{v:!1};e.uploadList.push({file:n[t]}),e.uploadLen++;var o=new FileReader;o.readAsDataURL(n[t]),o.onload=function(t){s=t.target.result,e.showImgArr.push(s)}},r=0;r<n.length;r++){var c=o(r);if("object"===Object(i["a"])(c))return c.v}},submitFunc:function(){var t=this;for(var e in t.loading=!0,t.commentOrderInfo)if(t.idSpecPrice[t.commentOrderInfo[e]["prodId"]]=t.commentOrderInfo[e]["goodsSpecId"],t.idProduct[e]=t.commentOrderInfo[e]["prodId"],!t.Eval["Product"][t.commentOrderInfo[e]["prodId"]])return void t.$message.error(t.$L("请完善评论信息"));var n=t.$route.params.id;t.imgList[n]={fileList:t.uploadList};var s={IDOrder:n,Score:{Desc:t.product,Service:t.service,KuaiDi:t.logistics},intShow:1,Eval:t.Eval,IDSpecPrice:t.idSpecPrice,IDProduct:t.idProduct,CommentsPic:{fileList:t.imgList}},a=t.$objToFormData(s);t.$api("addComment",a,(function(e){1===e.flag?(t.$message({type:"success",message:t.$L("提交成功!")}),t.$router.push({name:"checkComment"}),t.loading=!1):-1===e.flag?t.$confirm(t.$L("请重新登录"),t.$L("登录超时"),{confirmButtonText:t.$L("重新登录"),cancelButtonText:t.$L("取消"),type:"error",distinguishCancelAndClose:!0}).then((function(){t.$router.push({name:"login",query:{redirect:t.$route.fullPath}})})).catch((function(e){t.$gotoWebHome()})):t.$confirm(t.$L("数据加载失败"),t.$L("出错了"),{confirmButtonText:t.$L("点击重试"),cancelButtonText:t.$L("返回首页"),type:"error",distinguishCancelAndClose:!0}).then((function(){t.getData()})).catch((function(e){t.backFunc()}))}),(function(e){t.$confirm(t.$L("网络请求失败"),t.$L("出错了"),{confirmButtonText:t.$L("点击重试"),cancelButtonText:t.$L("返回首页"),type:"error",distinguishCancelAndClose:!0}).then((function(){t.getData()})).catch((function(e){t.backFunc()}))}),!0)}}},c=r,l=(n("31d4"),n("711a"),n("4023")),u=Object(l["a"])(c,s,a,!1,null,"755e3afc",null);e["default"]=u.exports},"711a":function(t,e,n){"use strict";var s=n("d18d"),a=n.n(s);a.a},a7e0:function(t,e,n){"use strict";var s=n("e0c1"),a=n.n(s);a.a},af9a:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"uploadPic"},[n("div",{staticClass:"up-load-pic"},[n("ul",{staticClass:"img-list"},[t._l(t.showImgArr,(function(e,s){return n("li",{key:s,staticClass:"load-img"},[n("div",{staticClass:"upload-list-cover"},[n("span",{staticClass:"bbx-font bbx-icon-shanchu",on:{click:function(e){return t.handleRemove(s)}}})]),n("img",{staticClass:"img",attrs:{src:e}})])})),t.showImgArr.length<t.maxNum?n("li",{staticClass:"load-img up-load-img"},[n("span",{staticClass:"bbx-font bbx-icon-jiahao"}),n("input",{staticClass:"upload",attrs:{type:"file",name:"CommentsPic",multiple:"",accept:"image/png,image/jpeg,image/jpg"},on:{change:t.upImgFunc}})]):t._e()],2)]),n("span",{staticClass:"img-num"},[t._v(t._s(t.uploadLen)+"/5")])])},a=[],i=n("4f54"),o=(n("163d"),{name:"uploadPic",props:{index:{type:Number},id:{id:Number}},data:function(){return{maxNum:5,uploadList:[],uploadLen:0,showImgArr:[]}},methods:{handleRemove:function(t){this.uploadList.splice(t,1),this.showImgArr.splice(t,1),this.uploadLen=this.showImgArr.length},upImgFunc:function(t){var e=this,n=t.target.files;console.log(n);var s=e.uploadLen,a=n.length+s;if(a>e.maxNum)return e.$message({showClose:!0,message:"最多可上传"+e.maxNum+"张，您还可以上传"+(e.maxNum-s)+"张",type:"success"}),!1;for(var o=function(t){var s=null,a=Math.floor(n[t].size/1024),i=n[t].type.substring(6);if(a>2097152)return e.$message({showClose:!0,message:"请选择2M以内的图片!",type:"warning"}),{v:!1};if("png"!==i&&"jpeg"!==i&&"jpg"!==i)return e.$message({showClose:!0,message:"请选择png、jpeg、jpg的图片格式！",type:"warning"}),{v:!1};e.uploadList.push({file:n[t]}),e.uploadLen++;var o=new FileReader;o.readAsDataURL(n[t]),o.onload=function(t){s=t.target.result,e.showImgArr.push(s)}},r=0;r<n.length;r++){var c=o(r);if("object"===Object(i["a"])(c))return c.v}e.$emit("UpLoadPic",e.uploadList,e.id)}}}),r=o,c=(n("a7e0"),n("4023")),l=Object(c["a"])(r,s,a,!1,null,"4c66db92",null);e["a"]=l.exports},d18d:function(t,e,n){},e0c1:function(t,e,n){},eb92:function(t,e,n){}}]);
//# sourceMappingURL=chunk-37599b26.500bcf0f.js.map